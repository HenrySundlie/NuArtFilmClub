import{r}from"./react-Afj6T7yh.js";function E(h={}){const{maxLines:d=2,minFontSizePx:a=12,maxFontSizePx:f,deps:x=[]}=h,u=r.useRef(null),p=r.useRef(()=>{}),b=r.useRef(null),S=r.useRef(null),i=r.useCallback(()=>{const t=u.current;if(!t)return;t.style.fontSize="";const s=getComputedStyle(t);let o=f??parseFloat(s.fontSize||"16");if(o=Math.max(o,Math.ceil(o)),!isFinite(o)||o<=0)return;const e=document.createElement("div");e.textContent=t.textContent??"",["fontFamily","fontWeight","fontStyle","letterSpacing","textTransform","textIndent","wordSpacing","whiteSpace","wordBreak","overflowWrap","textRendering","hyphens"].forEach(n=>{e.style[n]=s[n]}),e.style.position="fixed",e.style.top="-9999px",e.style.left="0",e.style.visibility="hidden",e.style.pointerEvents="none",e.style.whiteSpace="normal",e.style.display="block",e.style.boxSizing="border-box",e.style.margin="0",e.style.padding="0",e.style.border="0";const g=Math.floor(t.clientWidth||t.getBoundingClientRect().width);e.style.width=`${g}px`,e.style.lineHeight=s.lineHeight,document.body.appendChild(e);const y=n=>{e.style.fontSize=`${n}px`;const R=(parseFloat(getComputedStyle(e).lineHeight||`${n*1.2}`)||n*1.2)*d+.5;return e.scrollHeight<=R};let c=a,l=Math.max(o,a);if(y(l)){t.style.fontSize=`${l}px`,document.body.removeChild(e);return}let m=c;for(;c<=l;){const n=Math.floor((c+l)/2);y(n)?(m=n,c=n+1):l=n-1}t.style.fontSize=`${m}px`,document.body.removeChild(e)},[d,a,f,...x]);return r.useLayoutEffect(()=>{i()},[i]),r.useEffect(()=>{const t=u.current;if(!t)return;const s=new ResizeObserver(()=>{requestAnimationFrame(i)});b.current=s,s.observe(t),t.parentElement&&s.observe(t.parentElement);const o=new MutationObserver(()=>{requestAnimationFrame(i)});return S.current=o,o.observe(t,{childList:!0,characterData:!0,subtree:!0}),p.current=()=>{s.disconnect(),o.disconnect()},()=>p.current()},[i]),r.useCallback(t=>{u.current=t},[])}export{E as u};
